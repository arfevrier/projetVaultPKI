listener "tcp" {  
  address          = "0.0.0.0:8200"  
  cluster_address  = "{{ansible_default_ipv4.address}}:8201" 
  tls_disable      = "true"
}

storage "raft" {
  node_id = "{{inventory_hostname}}"
  path  = "{{vault_data_dir}}data"
  {% for hosts in groups['vault'] %}
  retry_join {
    leader_api_addr   = "http://{{ hosts }}:8200"      
  }
  {% endfor %}
}

seal "transit" {
  address = "http://vault.trusted.toudherebarry.com:8200"
  disable_renewal = "false"
  token = "{{token}}"
  key_name = "autounseal"
  mount_path = "transit/"
  tls_skip_verify = "true"
}

api_addr = "http://{{ansible_default_ipv4.address}}:8200"
cluster_addr = "https://{{ansible_default_ipv4.address}}:8201"
ui = true
